---
description: 
globs: 
alwaysApply: true
---
# íƒœê·¸ ê´€ë¦¬ ë°©ì•ˆ

## ğŸ“‹ ê°œìš”

ì´ ë¬¸ì„œëŠ” Mozart Cloud Terraform í”„ë¡œì íŠ¸ì˜ íƒœê·¸ ê´€ë¦¬ ë°©ì•ˆì„ ì„¤ëª…í•©ë‹ˆë‹¤.

## ğŸ·ï¸ íƒœê·¸ ì •ì±…

### í•„ìˆ˜ íƒœê·¸
ëª¨ë“  AWS ë¦¬ì†ŒìŠ¤ì—ëŠ” ë‹¤ìŒ 3ê°œì˜ í•„ìˆ˜ íƒœê·¸ê°€ ì ìš©ë©ë‹ˆë‹¤:

| íƒœê·¸ í‚¤ | ì„¤ëª… | í—ˆìš© ê°’ | ì˜ˆì‹œ ê°’ |
|---------|------|---------|---------|
| `Name` | AWS ë¦¬ì†ŒìŠ¤ ì´ë¦„ ì°¸ì¡° | AWS ë¦¬ì†ŒìŠ¤ ì´ë¦„ | `vmss3-hyperbilling`, `S3ReadAccessRole` |
| `Environment` | í™˜ê²½ êµ¬ë¶„ | `all`, `dev`, `stg`, `prd` | `dev`, `stg`, `prd` |
| `Project` | í”„ë¡œì íŠ¸ëª… | `mozart-cloud` (ê³ ì •) | `mozart-cloud` |

### íƒœê·¸ êµ¬ì¡°
```hcl
variable "common_tags" {
  description = "ëª¨ë“  ë¦¬ì†ŒìŠ¤ì— ì ìš©í•  ê³µí†µ íƒœê·¸"
  type = object({
    Name        = string
    Environment = string
    Project     = string
  })
  default = {
    Name        = "-"                   # ê¸°ë³¸ê°’ì€ - ì´ê³ , ê° ë¦¬ì†ŒìŠ¤ë³„ë¡œ Name ì„¸íŒ…
    Environment = "dev"                  # all, dev, stg, prd ì¤‘ ì„ íƒ
    Project     = "mozart-cloud"         # ê³ ì •ê°’
  }
}
```

## ğŸ“ íŒŒì¼ êµ¬ì¡°

```
ou-Security/Logs/
â”œâ”€â”€ variables.tf          # ê³µí†µ íƒœê·¸ ë³€ìˆ˜ ì •ì˜ (ê¸°ë³¸ê°’ ì„¤ì •)
â”œâ”€â”€ s3.tf                # S3 ë¦¬ì†ŒìŠ¤ (var.common_tags ì‚¬ìš©)
â”œâ”€â”€ iam.tf               # IAM ë¦¬ì†ŒìŠ¤ (var.common_tags ì‚¬ìš©)
â”œâ”€â”€ outputs.tf           # ì¶œë ¥ê°’
â”œâ”€â”€ main.tf              # ë©”ì¸ ì„¤ëª…
â”œâ”€â”€ .mdc                 # ì´ ë¬¸ì„œ (Cursor ì°¸ì¡°ìš©)
```

## ğŸ”§ ì‚¬ìš© ë°©ë²•

### 1. ë¦¬ì†ŒìŠ¤ì— íƒœê·¸ ì ìš© (ê¸°ë³¸)
```hcl
resource "aws_s3_bucket" "hyperbilling" {
  bucket = "vmss3-hyperbilling"
  tags   = var.common_tags
}
```

### 2. Name íƒœê·¸ì— AWS ë¦¬ì†ŒìŠ¤ ì´ë¦„ ì ìš© (ê¸°ë³¸)
```hcl
resource "aws_s3_bucket" "hyperbilling" {
  bucket = "vmss3-hyperbilling"
  tags = merge(var.common_tags, {
    Name = "vmss3-hyperbilling"  # AWS ë¦¬ì†ŒìŠ¤ ì´ë¦„ê³¼ ë™ì¼
  })
}
```

### 3. í™˜ê²½ë³„ íƒœê·¸ ì ìš©
`terraform.tfvars` íŒŒì¼ì„ ìƒì„±í•˜ì—¬ í™˜ê²½ë³„ë¡œ ë‹¤ë¥¸ íƒœê·¸ ì ìš©:
```hcl
# terraform.tfvars
common_tags = {
  Name        = "-"
  Environment = "dev"  # all, dev, stg, prd ì¤‘ ì„ íƒ
  Project     = "mozart-cloud"  # ê³ ì •ê°’
}
```

### 4. ì¶”ê°€ íƒœê·¸ ì ìš© ë°©ë²• (ìœ ì¼ í—ˆìš© ë°©ë²•)
**âš ï¸ í•„ìˆ˜ ê·œì¹™:**
íƒœê·¸ëŠ” ê¼­ í•„ìš”í•œ ê²½ìš°ì—ë§Œ ì¶”ê°€ë¡œ ì ìš©í•œë‹¤.
ê¸°ë³¸ì ìœ¼ë¡œëŠ” common_tagsë§Œ ì‚¬ìš©í•˜ë˜, ì‚¬ìš©ìì˜ ë³„ë„ ìš”ì²­ì´ ìˆì„ ë•Œë§Œ í•´ë‹¹ íƒœê·¸ë¥¼ ì¶”ê°€í•œë‹¤.

**ë°©ë²• 3: ë¦¬ì†ŒìŠ¤ë³„ ê°œë³„ íƒœê·¸ë§Œ ì‚¬ìš© (ë‹¤ë¥¸ ë°©ë²• ê¸ˆì§€)**

```hcl
resource "aws_s3_bucket" "hyperbilling" {
  bucket = "vmss3-hyperbilling"
  tags = merge(var.common_tags, {
    Name         = "vmss3-hyperbilling"
    Owner        = "data-team"              # ìš”ì²­ì‹œ
    CostCenter   = "cc-12345"               # ìš”ì²­ì‹œ
    DataClass    = "confidential"           # ìš”ì²­ì‹œ
    StorageClass = "intelligent-tiering"    # ìš”ì²­ì‹œ
    Retention    = "1-year"                 # ìš”ì²­ì‹œ
  })
}
```

**âš ï¸ ê¸ˆì§€ëœ ë°©ë²•ë“¤:**
- âŒ ë°©ë²• 1: merge() í•¨ìˆ˜ì— ë³€ìˆ˜ ì‚¬ìš©
- âŒ ë°©ë²• 2: locals ë¸”ë¡ ì‚¬ìš©
- âŒ ë‹¤ë¥¸ ì¶”ê°€ íƒœê·¸ ì ìš© ë°©ë²•

## ğŸ¯ íƒœê·¸ ê´€ë¦¬ ì›ì¹™

### 1. ì¼ê´€ì„±
- ëª¨ë“  ë¦¬ì†ŒìŠ¤ì— ë™ì¼í•œ íƒœê·¸ êµ¬ì¡° ì ìš©
- íƒœê·¸ í‚¤ëŠ” PascalCase, íƒœê·¸ ê°’ì€ snake_case ì‚¬ìš© (ìµœëŒ€í•œ ì§€í‚¤ê³  ì–´ì©” ìˆ˜ ì—†ìœ¼ë©´ í—ˆìš©)

### 2. ë‹¨ìˆœì„±
- í•„ìˆ˜ íƒœê·¸ë§Œ ì‚¬ìš©í•˜ì—¬ ë³µì¡ì„± ìµœì†Œí™”
- ì¶”ê°€ íƒœê·¸ëŠ” íŠ¹ë³„í•œ ìš”êµ¬ì‚¬í•­ì´ ìˆì„ ë•Œë§Œ ì‚¬ìš©

### 3. ìë™í™”
- Terraformì„ í†µí•œ íƒœê·¸ ìë™ ì ìš©
- ìˆ˜ë™ íƒœê·¸ ì„¤ì • ê¸ˆì§€

### 4. ëª…ëª… ê·œì¹™
- **íƒœê·¸ í‚¤**: PascalCase (ì˜ˆ: `DataClass`, `CostCenter`, `StorageClass`)
- **íƒœê·¸ ê°’**: snake_case (ì˜ˆ: `data_team`, `cc_12345`, `intelligent_tiering`)
- **ì˜ˆì™¸**: AWS ë¦¬ì†ŒìŠ¤ ì´ë¦„ì€ ì›ë³¸ ê·¸ëŒ€ë¡œ ì‚¬ìš© (ì˜ˆ: `vmss3-hyperbilling`)

## ğŸ“Š íƒœê·¸ í™œìš©

### 1. ë¹„ìš© ê´€ë¦¬
- Environment íƒœê·¸ë¥¼ í†µí•œ í™˜ê²½ë³„ ë¹„ìš© ë¶„ì„
- Project íƒœê·¸ë¥¼ í†µí•œ í”„ë¡œì íŠ¸ë³„ ë¹„ìš© ì¶”ì 

### 2. ë¦¬ì†ŒìŠ¤ ê´€ë¦¬
- Name íƒœê·¸ë¥¼ í†µí•œ ë¦¬ì†ŒìŠ¤ ì‹ë³„
- Environment íƒœê·¸ë¥¼ í†µí•œ í™˜ê²½ë³„ ë¦¬ì†ŒìŠ¤ ê·¸ë£¹í™”

### 3. ë³´ì•ˆ ì •ì±…
- Project íƒœê·¸ë¥¼ í†µí•œ ì ‘ê·¼ ì œì–´
- Environment íƒœê·¸ë¥¼ í†µí•œ ë³´ì•ˆ ì •ì±… ì ìš©

## ğŸ”„ íƒœê·¸ ë³€ê²½ ì ˆì°¨

### 1. ê°œë°œ í™˜ê²½
1. `variables.tf`ì—ì„œ íƒœê·¸ ê°’ ìˆ˜ì •
2. `terraform plan`ìœ¼ë¡œ ë³€ê²½ì‚¬í•­ í™•ì¸
3. `terraform apply`ë¡œ ë³€ê²½ ì ìš©

### 2. ìš´ì˜ í™˜ê²½
1. ë³€ê²½ì‚¬í•­ì„ ì½”ë“œ ë¦¬ë·°
2. í…ŒìŠ¤íŠ¸ í™˜ê²½ì—ì„œ ê²€ì¦
3. ìš´ì˜ í™˜ê²½ì— ë‹¨ê³„ì  ì ìš©

## âš ï¸ ì£¼ì˜ì‚¬í•­

### 1. íƒœê·¸ ë³€ê²½ ì‹œ ì˜í–¥ë„
- ê¸°ì¡´ ë¦¬ì†ŒìŠ¤ì˜ íƒœê·¸ ë³€ê²½ ì‹œ Terraform ìƒíƒœ ì—…ë°ì´íŠ¸ í•„ìš”
- íƒœê·¸ ë³€ê²½ìœ¼ë¡œ ì¸í•œ ë¦¬ì†ŒìŠ¤ ì¬ìƒì„± ê°€ëŠ¥ì„± ê³ ë ¤

### 2. íƒœê·¸ ì œí•œì‚¬í•­
- AWS íƒœê·¸ ì œí•œ: ìµœëŒ€ 50ê°œ íƒœê·¸, í‚¤/ê°’ ê°ê° 128ì ì œí•œ
- íƒœê·¸ í‚¤ëŠ” ê³ ìœ í•´ì•¼ í•¨

### 3. ë°±ì—… ë° ë³µêµ¬
- íƒœê·¸ ë³€ê²½ ì „ Terraform ìƒíƒœ ë°±ì—…
- ë¡¤ë°± ê³„íš ìˆ˜ë¦½

## ğŸ“ˆ ëª¨ë‹ˆí„°ë§ ë° ê°ì‚¬

### 1. íƒœê·¸ ì¤€ìˆ˜ í™•ì¸
- AWS Configë¥¼ í†µí•œ íƒœê·¸ ì •ì±… ì¤€ìˆ˜ ëª¨ë‹ˆí„°ë§
- ì •ê¸°ì ì¸ íƒœê·¸ ê°ì‚¬ ìˆ˜í–‰

### 2. íƒœê·¸ ì‚¬ìš© í˜„í™©
- AWS Cost Explorerë¥¼ í†µí•œ íƒœê·¸ë³„ ë¹„ìš© ë¶„ì„
- íƒœê·¸ í™œìš©ë„ ì¸¡ì • ë° ê°œì„ 

## ğŸ”— ê´€ë ¨ ë¬¸ì„œ

- [AWS íƒœê·¸ ëª¨ë²” ì‚¬ë¡€](mdc:https:/docs.aws.amazon.com/whitepapers/latest/tagging-best-practices)
- [Terraform íƒœê·¸ ê´€ë¦¬](mdc:https:/www.terraform.io/docs/language/values/variables.html)
- [AWS Cost Allocation Tags](mdc:https:/docs.aws.amazon.com/awsaccountbilling/latest/aboutv2/cost-alloc-tags.html)







